{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/django/migration/",
    "result": {"data":{"cur":{"id":"c1198dc0-ed7e-5c80-af52-2abfb0e265a7","html":"<p>ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©° ëª¨ë¸ì„ ë³€ê²½í•´ì•¼ í•  ì¼ì´ ìƒˆê²¼ë‹¤.\ní…Œì´ë¸”ì„ ìˆ˜ì •í•˜ê³  migrationì„ ì ìš©í•˜ë©´ì„œ dependency ì˜¤ë¥˜ë¶€í„° relationExists ì˜¤ë¥˜ê¹Œì§€ ì•„ì£¼ ë‚œí•­ì„ ê²ªì—ˆë‹¤.</p>\n<p>ì‚¬ì‹¤ í† ì´í”„ë¡œì íŠ¸ì—ì„œëŠ” migrationì´ ê¼¬ì´ë©´ ê·¸ëƒ¥ ì „ë¶€ ë°€ì–´ë²„ë¦¬ê³  ë‹¤ì‹œ ì ìš©í•˜ë©´ ê·¸ë§Œì´ì—ˆë‹¤.\ní•˜ì§€ë§Œ ì‹¤ì œë¡œ ë°°í¬ë˜ê³  ë°ì´í„°ê°€ ë‹´ê²¨ ìˆëŠ” DBì˜ í…Œì´ë¸”ì„ ìˆ˜ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” ì´ëŸ° 1ì°¨ì›ì ì¸ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ëŠ” ì—†ì—ˆë‹¤.</p>\n<p>ë‹¤ì†Œ ê¸´ ì‚½ì§ˆì˜ ê³¼ì •ì„ ê²½í—˜í•˜ë©°, ë‚´ê°€ migrationì— ëŒ€í•˜ì—¬ ì •í™•íˆ ì´í•´ë¥¼ í•˜ì§€ ëª»í•˜ê³  ìˆìŒì„ ê¹¨ë‹¬ì•˜ë‹¤.</p>\n<br>\n<h2 id=\"migrationì´ë€\" style=\"position:relative;\"><a href=\"#migration%EC%9D%B4%EB%9E%80\" aria-label=\"migrationì´ë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Migrationì´ë€?</h2>\n<p>ì¼ì¢…ì˜ database version control logë¼ê³  ì´í•´í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.\n<code class=\"language-text\">python manage.py makemigrations</code> ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ë©´ ê° appì˜ ëª¨ë¸ì— ëŒ€í•œ ë³€ê²½ì‚¬í•­ì„ ê¸°ë¡í•œ python scriptê°€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ê³ </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ python manage.py makemigrations <span class=\"token punctuation\">[</span>app_name<span class=\"token punctuation\">]</span>\nMigrations <span class=\"token keyword\">for</span> <span class=\"token string\">'users'</span><span class=\"token builtin class-name\">:</span>\n  apps/users/migrations/0002_user_auth_id_user_social_type.py\n    - Add field auth_id to <span class=\"token function\">users</span>\n    - Add field social_type to <span class=\"token function\">users</span></code></pre></div>\n<p><code class=\"language-text\">python manage.py migrate</code> ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ë©´ dbì— ë³€ê²½ì‚¬í•­ì„ ë°˜ì˜í•  ìˆ˜ ìˆë‹¤.\nì´ migration scriptëŠ” <code class=\"language-text\">000X_changelog_contents_whatever.py</code> í˜•ì‹ìœ¼ë¡œ ë„¤ì´ë°ë˜ë©°,\nëª¨ë¸ ê°„ì˜ ê´€ê³„(ìƒì„± ìˆœì„œ, ì°¸ì¡° ë°©í–¥ ë“±)ë¥¼ ê³ ë ¤í•˜ì—¬ ìˆœì°¨ì ìœ¼ë¡œ dependencyê°€ ì¡´ì¬í•œë‹¤.</p>\n<p>ì˜ˆë¥¼ ë“¤ì–´, <code class=\"language-text\">BookObject</code> í…Œì´ë¸”ì—ì„œ <code class=\"language-text\">User</code> í…Œì´ë¸”ì„ FKë¡œ ì°¸ì¡°í•˜ê³  ìˆëŠ” ê²½ìš°ë¼ë©´\në°˜ë“œì‹œ <code class=\"language-text\">User</code> í…Œì´ë¸”ì˜ ìƒì„±ì´ ì„ í–‰ë˜ì–´ì•¼ë§Œ <code class=\"language-text\">BookObject</code> í…Œì´ë¸”ì„ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span>AbstractUser<span class=\"token punctuation\">,</span> TimeStampModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    username <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    email <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>EmailField<span class=\"token punctuation\">(</span>\n        max_length<span class=\"token operator\">=</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span>\n        verbose_name<span class=\"token operator\">=</span><span class=\"token string\">'ì´ë©”ì¼'</span><span class=\"token punctuation\">,</span>\n        validators<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>SpecificEmailDomainValidator<span class=\"token punctuation\">(</span>allowlist<span class=\"token operator\">=</span>domain_allowlist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span>\n    \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BookObject</span><span class=\"token punctuation\">(</span>TimeStampModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    user <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>ForeignKey<span class=\"token punctuation\">(</span>\n        User<span class=\"token punctuation\">,</span>\n        on_delete<span class=\"token operator\">=</span>models<span class=\"token punctuation\">.</span>CASCADE<span class=\"token punctuation\">,</span>\n        related_name<span class=\"token operator\">=</span><span class=\"token string\">'note'</span><span class=\"token punctuation\">,</span>\n        verbose_name<span class=\"token operator\">=</span><span class=\"token string\">'ì‘ì„±ì'</span>\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<p>ë”°ë¼ì„œ <code class=\"language-text\">BookObject</code> appì˜ migrationì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ dependency(<code class=\"language-text\">users.migrations.0001_initial.py</code> ì„ ì ìš©í•œ í›„ì— í•´ë‹¹ migrationì„ ì ìš©í•  ìˆ˜ ìˆìŒ)ê°€ ëª…ì‹œë˜ì–´ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Migration</span><span class=\"token punctuation\">(</span>migrations<span class=\"token punctuation\">.</span>Migration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    initial <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n    dependencies <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'users'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0001_initial'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span></code></pre></div>\n<br>\n<h2 id=\"ì ìš©ëœ-migration-í™•ì¸í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EC%A0%81%EC%9A%A9%EB%90%9C-migration-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"ì ìš©ëœ migration í™•ì¸í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì ìš©ëœ migration í™•ì¸í•˜ê¸°</h2>\n<p>migration ì ìš© ë‚´ì—­ì€ <code class=\"language-text\">django_migrations</code> í…Œì´ë¸”ì— ì €ì¥ë˜ëŠ”ë°\nì´ ë•Œ ë°ì´í„°ë² ì´ìŠ¤ì— migration ë‚´ìš©ì€ ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤. ì ìš© ìˆœì„œ, scriptëª…, ì‹œê°„ ì •ë„ì˜ ë°ì´í„°ë§Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 654px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpklEQVQoz02QS4/TMBRG82OAPtLntI0TO7Gd2EnbZNIWNKOO0GxY8VgiJHazmS0rfgH/9KB4ALE4sq/96d5jRxvrUDZjk6zYZmtukiVCCaRJkUpircP5JuD/rAFX4yqHtdXL3jcYUxJtRYI8OL58+877Tx/ZeotwmrnNkb7GH24xTYttOsp9hx1oWsr2Qnm60t89UHdndN0ifUd0//DI0/NPnn784vPXZ0zTcWjPJLqh7i5Y55mvN8xWAzdhjZdrpqsdwrV053dYV5Nbh9COyJ+vXB8/MI1jEiHQuUIpiUi2lMZgjCEVgt12S7LbBebzGW9evyITCblSaF1Qe49MBVHlPXV7Io6nGK2pnGM0GrFer+n7E03ThKZaG/KiQGsd2O2ScLbf70Om73tsWRJJ42gvd0ynU4QQpGnGeDxmvlhQliV5nqPyPDQpiiI0Xy6XYeiQV0oFrLUIkRJJlYeGcRyHsPvP8Hy5cDweg0XXdYHBZjabhcwwZKjrv4bWErW3Pd3beyaTCVmWIaUMhovFgqqqguHLk/U/yyEz2A354X74irKqQv0b7HkWVto5kqAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"migration-001.png\"\n        title=\"migration-001.png\"\n        src=\"/static/79119921aca3628b1ab042b232a4fbe6/68e9c/migration-001.png\"\n        srcset=\"/static/79119921aca3628b1ab042b232a4fbe6/e9ff0/migration-001.png 180w,\n/static/79119921aca3628b1ab042b232a4fbe6/f21e7/migration-001.png 360w,\n/static/79119921aca3628b1ab042b232a4fbe6/68e9c/migration-001.png 654w\"\n        sizes=\"(max-width: 654px) 100vw, 654px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ë”°ë¼ì„œ ì´ë¯¸ ì ìš©ëœ migration scriptë¥¼ ìˆ˜ì •í•œ ë’¤ ë‹¤ì‹œ migrateë¥¼ ìˆ˜í–‰í•œë‹¤ê³  í•´ë„ <code class=\"language-text\">django_migration</code> í…Œì´ë¸”ì— ë³€ê²½ ë‚´ìš©ì€ ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.\në°ì´í„°ë² ì´ìŠ¤ì— ìˆ˜ì • ë‚´ìš©ì´ ë°˜ì˜ë˜ì§€ ì•Šê³  ì¶©ëŒì´ ì¼ì–´ë‚  ìˆ˜ë„ ìˆë‹¤.</p>\n<p><code class=\"language-text\">python manage.py showmigrations</code> ë¥¼ í†µí•´ì„œë„ í•œëˆˆì— migration ì ìš©ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACWElEQVQ4y6WUy27TQBSG7ahICAFCdS7jxk7jS+w0vsTjmfjWum6q0lYgJF6Fp2DHA/AiLKALGtixYolALHmEyjD4oHFTU0qDKmHp1z9Htr85l7GFF8/mwtMi2tw/iGmWZMF2kuIsSXCWpLjYyfHx4RE+mO/j44eH+Mmjx3he7OE0Pr+/naY4jWM8LwpyfHQ0EpZX6yAlr/K9CIIgPKOElJTQEge4TNOszHfyMs93y2K3qNdpkpYhDutnwrD2M8/1YLK19XFtbe0uB952vOl738dgWXY11DRQFAVUdQB9RQGEEMiyDEiWodfr1euNjY1a8rlXPYSg0+l8bbVanXOg45yGhAAOyQ/X9arJxKkc1634BoPBoJJluUIINX5FrN4Qoc+iKLZroOt6izAk4Hk+s8djMM0RGKbJM66dv/AP/VwCvzRAwzQXhM54hsz3p4BxCDx2HBf6/f7vspd+WQihv4GWZS0onUEQYOZ6PvjTAAihYNvjpmfXwVYC7fF4kaQZUDpjQYCBziKIorh2HiuXhnPDDO3FLIohihNGKYclkGbbEIYUNofDVaWuBjp8KITyITDTNEHXDeCu6XoDvBA/Opd7ujJDDnQ9j2ma3vSND4SfRaWRCqqq/tHTa4Fbk8nbvJjDLErKOsvRiHEfWRYzzRHTdZ1pus50w6hjVVXZ8vxx/74EfmqAvud9INMA/MmkLnU41MAwjDqjixKvK/lKT7+Jolh/KbcG3e5zs9t+Z3fbr7uSdLK+vn4iSdJN9UaSpFNJkl4KgnBf8B/c49A7giC0/1P8xyD+AtusTtEftjpwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"migration-002.png\"\n        title=\"migration-002.png\"\n        src=\"/static/38c649a1c8172d2f564b963ba7007f55/37523/migration-002.png\"\n        srcset=\"/static/38c649a1c8172d2f564b963ba7007f55/e9ff0/migration-002.png 180w,\n/static/38c649a1c8172d2f564b963ba7007f55/f21e7/migration-002.png 360w,\n/static/38c649a1c8172d2f564b963ba7007f55/37523/migration-002.png 720w,\n/static/38c649a1c8172d2f564b963ba7007f55/302a4/migration-002.png 1080w,\n/static/38c649a1c8172d2f564b963ba7007f55/07a9c/migration-002.png 1440w,\n/static/38c649a1c8172d2f564b963ba7007f55/24def/migration-002.png 1812w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><br><br></p>\n<h2 id=\"ì´ë¯¸-ì ìš©ëœ-migrationì„-revertí•˜ê³ -ì‹¶ì€-ê²½ìš°\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8-%EC%A0%81%EC%9A%A9%EB%90%9C-migration%EC%9D%84-revert%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\" aria-label=\"ì´ë¯¸ ì ìš©ëœ migrationì„ revertí•˜ê³  ì‹¶ì€ ê²½ìš° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ë¯¸ ì ìš©ëœ migrationì„ Revertí•˜ê³  ì‹¶ì€ ê²½ìš°?</h2>\n<p>ì•„ë˜ì™€ ê°™ì´ Revertí•˜ê³ ì í•˜ëŠ” appì˜ ì´ë¦„ê³¼ migration ë²ˆí˜¸ë¥¼ ëª…ì‹œí•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ python manage.py migrate <span class=\"token punctuation\">[</span>app_name<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>number<span class=\"token punctuation\">]</span>\n</code></pre></div>\n<p>ì˜ˆë¥¼ ë“¤ì–´ 0004ê¹Œì§€ migrationì´ ì ìš©ë˜ì–´ ìˆëŠ” User appì´ ìˆë‹¤ê³  í•˜ì.\n<code class=\"language-text\">python manage.py migrate users 0002</code> ë¼ëŠ” ëª…ë ¹ì„ ìˆ˜í–‰í•˜ë©´, 0003 ì´í›„ì˜ migrationì€ unapplyë˜ê³  0002 migration ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ê°€ ë™ì‘í•œë‹¤</p>\n<p>ì´ ë•Œ, ì£¼ì˜í•˜ì—¬ì•¼ í•  ì ì€ ë˜ëŒë¦¬ê³ ì ì‹œì  ì´í›„ì— ëŒ€í•œ migration scriptë¥¼ ì ˆëŒ€ ì‚­ì œí•´ì„œëŠ” ì•ˆëœë‹¤ëŠ” ê²ƒì´ë‹¤!\në°ì´í„°ë² ì´ìŠ¤ëŠ” ì‚¬ìš©ìê°€ ì…ë ¥í•œ ëª…ë ¹ì„ <b>ì¡´ì¬í•˜ì§€ë„ ì•ŠëŠ” migrationì„ revertí•˜ë ¤ëŠ” ê²ƒ</b>ìœ¼ë¡œ ì´í•´í•  ê²ƒì´ë‹¤.\nì‚­ì œëœ migrationì„ ë³µêµ¬í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ë¼ë©´ ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.</p>\n<br>\n<h2 id=\"ì´ë¯¸-ì ìš©ëœ-migration-ë‚´ìš©ì„-ìˆ˜ì •í•˜ê³ -ì‹¶ì€-ê²½ìš°\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8-%EC%A0%81%EC%9A%A9%EB%90%9C-migration-%EB%82%B4%EC%9A%A9%EC%9D%84-%EC%88%98%EC%A0%95%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\" aria-label=\"ì´ë¯¸ ì ìš©ëœ migration ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì‹¶ì€ ê²½ìš° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ë¯¸ ì ìš©ëœ migration ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì‹¶ì€ ê²½ìš°?</h2>\n<p>në²ˆì§¸ migration ì ìš© ë‚´ì—­ì„ ìˆ˜ì •í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•˜ë©´ ë ê¹Œ?\nn+1ë²ˆì§¸ì˜ ìƒˆë¡œìš´ migration scriptë¥¼ ìƒì„±í•˜ë©´ ëœë‹¤. ìœ„ì— ì–¸ê¸‰í•œ ê²ƒì²˜ëŸ¼\nì´ë¯¸ ì ìš©ëœ migrationì„ ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶©ëŒì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ë„ ìˆê³ , ì´í›„ì— ì ìš©í•  migrationì—ì„œ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ë„ ìˆë‹¤.</p>\n<p>ê·¸ë˜ë„ në²ˆì§¸ë¡œ ì ìš©ëœ migrationì„ ìˆ˜ì •í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ê°œë°œì„ í•˜ê³  ì‹¶ë‹¤ë©´,\nì´ì „ n-1ë²ˆì§¸ versionìœ¼ë¡œ revertë¥¼ ìˆ˜í–‰í•œë’¤ì— ìƒˆë¡­ê²Œ në²ˆì§¸ migration scriptë¥¼ ìƒì„±í•˜ê³  ì ìš©í•˜ë©´ ëœë‹¤.</p>\n<br>\n<h2 id=\"migrationì„-squashí•˜ì—¬-logë¥¼-ê´€ë¦¬í•˜ê³ -ì‹¶ì€-ê²½ìš°\" style=\"position:relative;\"><a href=\"#migration%EC%9D%84-squash%ED%95%98%EC%97%AC-log%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\" aria-label=\"migrationì„ squashí•˜ì—¬ logë¥¼ ê´€ë¦¬í•˜ê³  ì‹¶ì€ ê²½ìš° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>migrationì„ Squashí•˜ì—¬ logë¥¼ ê´€ë¦¬í•˜ê³  ì‹¶ì€ ê²½ìš°?</h2>\n<p><code class=\"language-text\">python manage.py squashmigrations</code>ë¥¼ ì‚¬ìš©í•˜ì—¬\nì¡´ì¬í•˜ëŠ” ë§ì€ ìˆ˜ì˜ migrationì„ í•œ ê°œ(ë˜ëŠ” ê·¸ ì´ìƒ)ì˜ migrationìœ¼ë¡œ í•©ì³ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>\n<p>ì˜ˆë¥¼ ë“¤ì–´ <code class=\"language-text\">CreateModel</code>ê³¼ <code class=\"language-text\">DeleteModel</code> actionì„ í•©ì¹  ìˆ˜ ìˆê³ , <code class=\"language-text\">AddField</code> actionì„ <code class=\"language-text\">CreateModel</code> ë‚´ë¶€ë¡œ roll ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>\n<p>squashëœ migrationê³¼ ì´ì „ ë²„ì „ì˜ migration logëŠ” ë™ì‹œì— ì¡´ì¬í•  ìˆ˜ ìˆë‹¤.\nDjangoëŠ” migrationì´ ì ìš©ë˜ëŠ” ì‹œì ì„ ìë™ìœ¼ë¡œ íŒŒì•…í•˜ì—¬ ìƒˆë¡œìš´ versionì—ì„œëŠ” squashëœ migrationì„ ì ìš©í•˜ê³  ì´ì „ ë²„ì „ì˜ migrationì„ skipí•œë‹¤.</p>\n<p><code class=\"language-text\">--squashed-name</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ squashí•  migration scriptì˜ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ë„ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ python manage.py squashmigrations <span class=\"token punctuation\">[</span>app_name<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>number<span class=\"token punctuation\">]</span> <span class=\"token parameter variable\">--squaushed_name</span> <span class=\"token punctuation\">[</span>SQUASHED_NAME<span class=\"token punctuation\">]</span>\nWill squash the following migrations:\n - 0001_initial\n - 0002_some_change\n - 0003_another_change\n - 0004_undo_something\nDo you wish to proceed? <span class=\"token punctuation\">[</span>y/N<span class=\"token punctuation\">]</span> y\nOptimizing<span class=\"token punctuation\">..</span>.\n  Optimized from <span class=\"token number\">12</span> operations to <span class=\"token number\">7</span> operations.\nCreated new squashed migration /home/andrew/Programs/DjangoTest/test/migrations/0001_squashed_0004_undo_somthing.py\n  You should commit this migration but leave the old ones <span class=\"token keyword\">in</span> place<span class=\"token punctuation\">;</span>\n  the new migration will be used <span class=\"token keyword\">for</span> new installs. Once you are sure\n  all instances of the codebase have applied the migrations you squashed,\n  you can delete them.</code></pre></div>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#migration%EC%9D%B4%EB%9E%80\">Migrationì´ë€?</a></li>\n<li><a href=\"#%EC%A0%81%EC%9A%A9%EB%90%9C-migration-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">ì ìš©ëœ migration í™•ì¸í•˜ê¸°</a></li>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8-%EC%A0%81%EC%9A%A9%EB%90%9C-migration%EC%9D%84-revert%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\">ì´ë¯¸ ì ìš©ëœ migrationì„ Revertí•˜ê³  ì‹¶ì€ ê²½ìš°?</a></li>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8-%EC%A0%81%EC%9A%A9%EB%90%9C-migration-%EB%82%B4%EC%9A%A9%EC%9D%84-%EC%88%98%EC%A0%95%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\">ì´ë¯¸ ì ìš©ëœ migration ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì‹¶ì€ ê²½ìš°?</a></li>\n<li><a href=\"#migration%EC%9D%84-squash%ED%95%98%EC%97%AC-log%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%BD%EC%9A%B0\">migrationì„ Squashí•˜ì—¬ logë¥¼ ê´€ë¦¬í•˜ê³  ì‹¶ì€ ê²½ìš°?</a></li>\n</ul>\n</div>","excerpt":"ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©° ëª¨ë¸ì„ ë³€ê²½í•´ì•¼ í•  ì¼ì´ ìƒˆê²¼ë‹¤.\ní…Œì´ë¸”ì„ ìˆ˜ì •í•˜ê³  migrationì„ ì ìš©í•˜ë©´ì„œ dependency ì˜¤ë¥˜ë¶€í„° relationExists ì˜¤ë¥˜ê¹Œì§€ ì•„ì£¼ ë‚œí•­ì„ ê²ªì—ˆë‹¤. ì‚¬ì‹¤ í† ì´í”„ë¡œì íŠ¸ì—ì„œëŠ” migrationì´ ê¼¬ì´ë©´ ê·¸ëƒ¥ ì „ë¶€ ë°€ì–´ë²„ë¦¬ê³  ë‹¤ì‹œ ì ìš©í•˜ë©´ ê·¸ë§Œì´ì—ˆë‹¤.\ní•˜ì§€ë§Œ ì‹¤ì œë¡œ ë°°í¬ë˜ê³  ë°ì´í„°ê°€ ë‹´ê²¨ ìˆëŠ” DBì˜ í…Œì´ë¸”ì„ ìˆ˜ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” ì´ëŸ° 1ì°¨ì›ì ì¸ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ëŠ” ì—†ì—ˆë‹¤. ë‹¤ì†Œ ê¸´ ì‚½ì§ˆì˜ ê³¼ì •ì„ ê²½í—˜í•˜ë©°, ë‚´ê°€ migrationì— ëŒ€í•˜ì—¬ ì •í™•íˆ ì´í•´ë¥¼ í•˜ì§€ ëª»í•˜ê³  ìˆìŒì„ ê¹¨ë‹¬ì•˜ë‹¤. Migrationì´ë€? ì¼ì¢…ì˜ database version control logë¼ê³  ì´í•´í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.\n ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ë©´ ê° appì˜ ëª¨ë¸ì— ëŒ€í•œ ë³€ê²½ì‚¬í•­ì„ ê¸°ë¡í•œ python scriptê°€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ê³   ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ë©´ dbì— ë³€ê²½ì‚¬í•­ì„ ë°˜ì˜í•  ìˆ˜ ìˆë‹¤.\nì´ migration scriptëŠ”  í˜•ì‹ìœ¼ë¡œ ë„¤ì´ë°ë˜ë©°,\nëª¨ë¸ ê°„ì˜ ê´€ê³„(ìƒì„± ìˆœì„œ, ì°¸ì¡° ë°©í–¥ ë“±)ë¥¼â€¦","frontmatter":{"date":"December 30, 2022","title":"Djangoì—ì„œ migrationìœ¼ë¡œ í…Œì´ë¸” ê´€ë¦¬í•˜ê¸°","categories":"ì›¹ í”„ë ˆì„ì›Œí¬","author":"ì†Œí¬","emoji":"ğŸ¤"},"fields":{"slug":"/django/migration/"}},"next":{"id":"16804f52-497a-59a5-92f4-51f8aa8d7bdd","html":"<p>Github Actionì€ <b>build, test, deploymentì™€ ê°™ì€ workflowë¥¼ ìë™í™”í•  ìˆ˜ ìˆëŠ” CI/CD í”Œë«í¼</b>ìœ¼ë¡œ,\ngithub repositoryì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë“  ì´ë²¤íŠ¸(push, pull request, merge ë“±)ì— ëŒ€í•˜ì—¬ ì •í•´ì§„ ë™ì‘ì„ ì‹¤í–‰ì‹œí‚¤ë„ë¡ í•  ìˆ˜ ìˆë‹¤.</p>\n<p>ì§„í–‰ì¤‘ì¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” <code class=\"language-text\">docker-compose</code>ë¥¼ ì´ìš©í•´ ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆë“¤ì„ ê´€ë¦¬í•˜ê³  ìˆë‹¤.\nì†ŒìŠ¤ì½”ë“œê°€ ìˆ˜ì •ë  ë•Œë§ˆë‹¤ ìˆ˜ë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•˜ê³  ë¹Œë“œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì„œë²„ë¥¼ ìš´ì˜í•˜ë‹¤ê°€ <code class=\"language-text\">Github Action</code>ì„ ì‚¬ìš©í•˜ì—¬ CI/CDë¥¼ ìë™í™”í•´ë³´ê¸°ë¡œ í–ˆë‹¤.</p>\n<br>\n<h2 id=\"cicd-í”„ë¡œì„¸ìŠ¤-ì„¤ê³„í•´ë³´ê¸°\" style=\"position:relative;\"><a href=\"#cicd-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%84%A4%EA%B3%84%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"cicd í”„ë¡œì„¸ìŠ¤ ì„¤ê³„í•´ë³´ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CI/CD í”„ë¡œì„¸ìŠ¤ ì„¤ê³„í•´ë³´ê¸°</h2>\n<p>ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë“¤ì„ ìë™í™”ì‹œí‚¤ë ¤ í•˜ì˜€ë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVQoz0WRu27cMBBF1TrepyRKosSHRL210nph2EkQpEqbMk2ANKkC5P8/4ASkg3VxwcE87gwOo26+YdxErBZS98JZryRqJjErdX+hn584pSUP+4THQ8rDLiYrG7bnzxg348Yr8/UVUdZI0xFdbh9x0xXlFky/YYcrql3Q7SUYNsOKbmeqeqCsJ3I7UeiW0g5I02O6BdstuHFDu4no+dNX6mG7J7vlFozqwWsN8gu9cVjWP5ErR1wYMuWomjHIzylvmFUtHw4ph7hgd8pC/HgUId6f8/DuTiLEvufoJRSHRL7Xz3mY8fXox68/FKoJFyS5/m+QBSal6ZC6pWoWctWSlTWptKRqZB/Le+8xkQGJkJbo5++/aDeimpGsaohzzUlUlLYPGHy+ajcy1b6ZeZWOODecRRV6PYK6X98+5cu372HYM/AMRdWQFAZp+zsfb+r5eIXPcStCdSTSkEgbrtduptAd/wAJUL4ZAyd6vgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cicd-001.png\"\n        title=\"cicd-001.png\"\n        src=\"/static/d4c07304f7de23c847b09043b3f9be09/37523/cicd-001.png\"\n        srcset=\"/static/d4c07304f7de23c847b09043b3f9be09/e9ff0/cicd-001.png 180w,\n/static/d4c07304f7de23c847b09043b3f9be09/f21e7/cicd-001.png 360w,\n/static/d4c07304f7de23c847b09043b3f9be09/37523/cicd-001.png 720w,\n/static/d4c07304f7de23c847b09043b3f9be09/c483d/cicd-001.png 751w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><em>github/workflowì— YAMLíŒŒì¼ ìƒì„±</em></p>\n<ol>\n<li>ìƒì„±ëœ pull requestì— ëŒ€í•˜ì—¬ <b>ìë™ìœ¼ë¡œ build í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰</b> â†’ ì‹¤íŒ¨ì‹œ merge ë¶ˆê°€</li>\n<li>main branchì— pull requestê°€ mergeëœ ê²½ìš°,\na) production ì„œë²„ì— ë™ì‘í•˜ë˜ ì»¨í…Œì´ë„ˆë¥¼ ì¤‘ì§€ / dangling imageë¥¼ ì‚­ì œí•˜ì—¬ ì„œë²„ ì—¬ìœ ê³µê°„ í™•ë³´\nb) production ì„œë²„ì— <b>ìƒˆë¡œìš´ containerë“¤ì„ ë¹Œë“œ</b>\nc) containerê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ê²½ìš°, <b>rollback</b></li>\n<li>pull requestë¥¼ í™œìš©í•œ ì†ŒìŠ¤ì½”ë“œ <b>release, tag ìƒì„± ë° ê´€ë¦¬ ìë™í™”</b></li>\n</ol>\n<br>\n<h2 id=\"githubë¥¼-í™œìš©í•œ-cicd-í™˜ê²½-ê´€ë¦¬\" style=\"position:relative;\"><a href=\"#github%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-cicd-%ED%99%98%EA%B2%BD-%EA%B4%80%EB%A6%AC\" aria-label=\"githubë¥¼ í™œìš©í•œ cicd í™˜ê²½ ê´€ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Githubë¥¼ í™œìš©í•œ CI/CD í™˜ê²½ ê´€ë¦¬</h2>\n<p><code class=\"language-text\">Repository > Settings > Secrets</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¸íŒ…í•œë‹¤.\nworkflowì—ì„œ env íŒŒì¼ì„ ìƒì„±í•˜ê³  ë¹„ë°€í‚¤ ê°’ë“¤ì„ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬í–ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLElEQVQ4y2WU2XLaQBBF9eg4rEL7LBqBYJBAYMCk7KosT/mRPCX//wE3dVvIhe2HqS7Ro9unb7cIosyirFuEicZolmA8T/F1GiPOSzTdM5a+w3Z/QaaXeBiFknucRnj4Mof+3eD87xdOf37g+Pc71E+PgIKL1IrQcCg8jxW08yhsDV155LYW0aRwyMwKuV5BdR72W4vqpYN73WPuNIIwNXDrHUzlYZdbaLfB4yRCqhx2x2f49oj90xXN/oz2cMHueEV3fsHh8oq1f0KaVtDGQ6k1JrMMAVuN8lIqz6JC6EbTGGFWwmxO0PUR1p9h/BnWX6CqBrlZQbmNEBdl3dObJdhtQKHN7oSiXGMcZhjdWp5GCmnZIC23EmPjEemNFKId80R/OtOo6D0sV42YPQyFkbTb7iLF1u0TUl1hkRnEyiEqnHQlsXCIeVQF2ieE7eGKwq5FdBjMJMykBZKb5VY2gZG/06ZUBlTJHbbu6p2Qi+DKd/JwP2VGXqZfjMyT+q0YCbMSYWJkxViY+SC+IXOyFOopE3mJF2k+L360hIJx7oSWpKba9oJMsJVhbdjaQEJ6u2yE7t4OHooRZJGa94JxZtEeryLUE2RvJAt6aGs5JL4XZK5vWb9v2dQHWWC+RK/i206SqvewFvrpIn8rNPgr3n5seZFX8LuTtE0RVuShAMX1nYf3hL2HPWGqKthVg1mkEIxniYjx+xyMH0hYgB5R/F5syA2T538B14j3/gPVb27Lq9MSqgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cicd-002.png\"\n        title=\"cicd-002.png\"\n        src=\"/static/f7f9e86e3dca7ad341667b65a4dadf64/37523/cicd-002.png\"\n        srcset=\"/static/f7f9e86e3dca7ad341667b65a4dadf64/e9ff0/cicd-002.png 180w,\n/static/f7f9e86e3dca7ad341667b65a4dadf64/f21e7/cicd-002.png 360w,\n/static/f7f9e86e3dca7ad341667b65a4dadf64/37523/cicd-002.png 720w,\n/static/f7f9e86e3dca7ad341667b65a4dadf64/c8e86/cicd-002.png 758w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 587px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz4WS2W7CMBBFeS5LQmJnc0lCFgJhX1SWUkClaqW+VO3//8utZiICtEg8HNmeia/vzKTidCLo0kNNt9AwXWjCO6+Gi3rTvoK+I/7GT1TUIIEdh3DDHlQyhBNksP0O3HYPwovwUDdRbYgCTV4J3xbspwj7M6TjLfxsCtvPYLVSuO2cUfGQz4RQ8X2HThpBdTMIFcEJe+yULjetFmM4AXT5yGhC3RekJPXRaiWQKmaoVM2kvkpUNcFrwW2hyzgLWn6KaLBEqzPhNZ1ukT8dEXTnV4OoabIUr2ryn1vas6BhBxBeG6YbnqGzE0KXiqdN5RZle7yndtDfQEI0MHqkcKhJNG0f8XCN6eELg80Hsvke/dU78uUbOrMdkvEG2WzHudH2E9lsX+SmL0jGz9x7MlU61IXiaUbDFeLRmqdN5Z+geJgv4EX9sr8NwyndEnRmQeqFYftIJ1vMX7/ZATki4e7igPnxh53RIyRQlGddcD2wX9t3BlBmSdckAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cicd-003.png\"\n        title=\"cicd-003.png\"\n        src=\"/static/3eca43c9227b3ee47247ddc66f09a18c/d72eb/cicd-003.png\"\n        srcset=\"/static/3eca43c9227b3ee47247ddc66f09a18c/e9ff0/cicd-003.png 180w,\n/static/3eca43c9227b3ee47247ddc66f09a18c/f21e7/cicd-003.png 360w,\n/static/3eca43c9227b3ee47247ddc66f09a18c/d72eb/cicd-003.png 587w\"\n        sizes=\"(max-width: 587px) 100vw, 587px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ì•„ë˜ì™€ ê°™ì´ repositoryì— Self-Hosted Runnerë¥¼ ë“±ë¡í•˜ì—¬ ê´€ë¦¬ ì¤‘ì¸ ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ë¹Œë“œì™€ ë°°í¬ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ í•˜ì˜€ë‹¤.\nrunnerëŠ” í”„ë¡œì íŠ¸ì˜ EC2 instanceì—ì„œ daemonìœ¼ë¡œ ë™ì‘í•˜ê³  ìˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQoz11R2W7CQAzcR8SRkGuPJHsQYIGQCFGpUvvQH2lf+v8/MZWtbot4GNnWrscztihlD7s7oVIW661EVmqs8obreL3DH0YssxqrR+Q1lqsKuTO4fL7i+vWG6fsd/ccZojYesg1MkkDEpbLYxQluf4G2e+h+D+0iQ9kjlI0wwxn+ZUa4X2FvZxSuhyiajhV2PjJad2DCbd1CdTsmav0R2h3RuBEyTGj8BBlmSD+jVAdscoVNprDOJARZNu6AfndiAiLaFAp5ZdD6CHJQyJ4VV4piz/EPxsHQsC7wH0G7GuIM1Q+sLIF2SZYr1WGxyrBYZqi05eZaezRt4LguFKQNaEzAptQQlXYYTjPIOu2P1CWQWtofkachpJxiQnJDoFxQE12zMZ4vSI2JkPLnIen9+V+qhQ4j4nhDF+LvEQZoO7Dix+bHpseaUfznP9o9zMdxKmyvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cicd-004.png\"\n        title=\"cicd-004.png\"\n        src=\"/static/fcf2e12f372d71ede39c7e5f620fe06c/37523/cicd-004.png\"\n        srcset=\"/static/fcf2e12f372d71ede39c7e5f620fe06c/e9ff0/cicd-004.png 180w,\n/static/fcf2e12f372d71ede39c7e5f620fe06c/f21e7/cicd-004.png 360w,\n/static/fcf2e12f372d71ede39c7e5f620fe06c/37523/cicd-004.png 720w,\n/static/fcf2e12f372d71ede39c7e5f620fe06c/3c051/cicd-004.png 760w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"workflow-êµ¬í˜„í•˜ê¸°\" style=\"position:relative;\"><a href=\"#workflow-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\" aria-label=\"workflow êµ¬í˜„í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Workflow êµ¬í˜„í•˜ê¸°</h2>\n<ol>\n<li>\n<p><code class=\"language-text\">build.yml</code></p>\n<ul>\n<li>ìƒì„±ëœ pull requestì— ëŒ€í•˜ì—¬ ìë™ìœ¼ë¡œ build í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” workflow</li>\n<li>ubuntu í™˜ê²½ êµ¬ì„± / containerì˜ ë™ì‘ì„ ê´€ë¦¬í•˜ëŠ” shell scriptë¥¼ ìˆ˜í–‰í•˜ëŠ” stepì„ ì‹¤í–‰í•˜ë„ë¡ êµ¬í˜„</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build Test\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>pull_request<span class=\"token punctuation\">]</span>  <span class=\"token comment\"># pull request eventì— ëŒ€í•˜ì—¬ triggerë˜ëŠ” workflow</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># í”„ë¡œì íŠ¸ ì†ŒìŠ¤ì½”ë“œë¥¼ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì— checkoutí•˜ê³  ì‹¤í–‰í•˜ë„ë¡ ëª…ì‹œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout source code\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n        \n    <span class=\"token comment\"># í•´ë‹¹ workflowë¥¼ python3.8 í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê² ë‹¤ê³  ëª…ì‹œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup python\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>python@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">python-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.8\"</span>\n    \n    <span class=\"token comment\"># ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì— dockerë¥¼ ì„¸íŒ…í•˜ëŠ” shell scriptë¥¼ ì‹¤í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Docker\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sh scripts/setup<span class=\"token punctuation\">-</span>docker.sh\n\n    <span class=\"token comment\"># ${{ secrets.* }} ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Settings > Secrets > Actionsì— ì •ì˜í•œ ê°’ì„ ê°€ì ¸ì˜¤ê³ </span>\n    <span class=\"token comment\"># .envíŒŒì¼ì„ ìƒì„±í•˜ì—¬ deví™˜ê²½ì˜ í™˜ê²½ë³€ìˆ˜ë¥¼ ê´€ë¦¬</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Create env file\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        touch ${{ secrets.ENV_PATH }}\n        {\n            echo SECRET_KEY=\"\\\"${{ secrets.SECRET_KEY }}\"\\\"\n            echo RUN_ENV=\"\\\"${{ secrets.RUN_ENV }}\"\\\"\n            echo DOMAIN=\"\\\"${{ secrets.DOMAIN }}\"\\\"\n            echo PROD_ALLOWED_HOSTS='${{ secrets.PROD_ALLOWED_HOSTS }}'\n            echo CORS_ORIGIN_WHITELIST='${{ secrets.CORS_ORIGIN_WHITELIST }}'\n            ...\n        } >> ${{ secrets.ENV_PATH }}</span>\n    \n    <span class=\"token comment\"># containterë¥¼ ë¹Œë“œí•˜ê³  ë°°í¬í•˜ëŠ” shell scriptë¥¼ ìˆ˜í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build Docker containers\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sudo kill `sudo lsof <span class=\"token punctuation\">-</span>t <span class=\"token punctuation\">-</span>i<span class=\"token punctuation\">:</span>8084` <span class=\"token important\">&amp;&amp;</span> sh scripts/build<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>compose.sh\n\n    <span class=\"token comment\"># containerì˜ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸í•œ ë’¤ jobì„ ì¢…ë£Œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Check container running state\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        if [ $(docker ps --format \"{{.Names}} {{.Status}}\" | grep \"Up\" | wc -l) -ne 3 ]\n        then\n            echo \"Build error while running docker-compose\"\n            exit 1\n        else\n            echo \"Deploy Complete\"\n        fi</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">schedule-deploy.yml</code></p>\n<ul>\n<li>production ì„œë²„ì— ë™ì‘í•˜ë˜ ì»¨í…Œì´ë„ˆë¥¼ ì¤‘ì§€ / dangling imageë¥¼ ì‚­ì œí•˜ì—¬ ì„œë²„ ê³µê°„ì„ í™•ë³´í•˜ëŠ” ë™ì‘ì„ ë³„ë„ì˜ shell scriptë¡œ ì‘ì„±í•˜ì—¬ workflowì˜ stepì—ì„œ ì‹¤í–‰</li>\n<li>production ì„œë²„ì— ìƒˆë¡œìš´ containerë“¤ì„ ë¹Œë“œ ë° ë°°í¬í•œë’¤ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸</li>\n<li>ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ê²½ìš°, ì´ì „ ë²„ì „ì˜ releaseë¡œ rollback</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Schedule Deployment\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>     <span class=\"token comment\"># main branchë¥¼ targetìœ¼ë¡œ í•˜ëŠ” pull requestê°€ closedë˜ì—ˆì„ ê²½ìš°ì—ë§Œ ë™ì‘í•˜ëŠ” workflow</span>\n<span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> main\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> closed\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">checkout</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># í”„ë¡œì íŠ¸ë¥¼ buildí•  machine(runner)ë¥¼ ëª…ì‹œ</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">-</span>go <span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># pull requestê°€ mergeëœ ê²½ìš°ì—ë§Œ checkout jobì„ ìˆ˜í–‰</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.pull_request.merged == true <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># runnerê°€ workflowë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ workspaceì— permission ë¶€ì—¬</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set Permissions\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sudo chown <span class=\"token punctuation\">-</span>R $USER<span class=\"token punctuation\">:</span>$USER $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.workspace <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># í”„ë¡œì íŠ¸ ì†ŒìŠ¤ì½”ë“œë¥¼ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì— checkoutí•˜ê³  ì‹¤í–‰í•˜ë„ë¡ ëª…ì‹œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout source code\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n        \n    <span class=\"token comment\"># í•´ë‹¹ workflowë¥¼ python3.8 í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê² ë‹¤ê³  ëª…ì‹œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup python\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>python@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">python-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.8\"</span>\n\n    <span class=\"token comment\"># ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì— dockerë¥¼ ì„¸íŒ…í•˜ëŠ” shell scriptë¥¼ ì‹¤í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Docker\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sh scripts/setup<span class=\"token punctuation\">-</span>docker.sh\n\n<span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">-</span>go <span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># checkout jobì´ ì™„ë£Œë˜ì—ˆì„ ê²½ìš° ë™ì‘í•˜ë„ë¡ ì˜ì¡´ê´€ê³„ë¥¼ ì„¤ì • </span>\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> checkout\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.pull_request.merged == true <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># ${{ secrets.* }} ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Settings > Secrets > Actionsì— ì •ì˜í•œ ê°’ì„ ê°€ì ¸ì˜¤ê³ </span>\n    <span class=\"token comment\"># .envíŒŒì¼ì„ ìƒì„±í•˜ì—¬ deví™˜ê²½ì˜ í™˜ê²½ë³€ìˆ˜ë¥¼ ê´€ë¦¬</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Create env file\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        touch ${{ secrets.ENV_PATH }}\n        {\n            echo SECRET_KEY=\"\\\"${{ secrets.SECRET_KEY }}\"\\\"\n            echo RUN_ENV=\"\\\"${{ secrets.RUN_ENV }}\"\\\"\n            echo DOMAIN=\"\\\"${{ secrets.DOMAIN }}\"\\\"\n            echo PROD_ALLOWED_HOSTS='${{ secrets.PROD_ALLOWED_HOSTS }}'\n            echo CORS_ORIGIN_WHITELIST='${{ secrets.CORS_ORIGIN_WHITELIST }}'\n            ...\n        } >> ${{ secrets.ENV_PATH }}</span>\n\n    <span class=\"token comment\"># containerë¥¼ ë¹Œë“œí•˜ê³  ë°°í¬í•˜ëŠ” shell scriptë¥¼ ìˆ˜í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build Docker containers\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sh scripts/build<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>compose.sh\n\n    <span class=\"token comment\"># containerì˜ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸í•œ ë’¤ jobì„ ì¢…ë£Œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Check container running state\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        if [ $(docker ps --format \"{{.Names}} {{.Status}}\" | grep \"Up\" | wc -l) -ne 3 ]\n        then\n            echo \"Build error while running docker-compose\"\n            exit 1\n        else\n            echo \"Deploy Complete\"\n        fi</span>\n\n<span class=\"token key atrule\">rollback</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">-</span>go <span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># checkout, deploy jobì´ ëª¨ë‘ ì™„ë£Œë˜ì—ˆì„ ê²½ìš° ë™ì‘í•˜ë„ë¡ ì˜ì¡´ê´€ê³„ë¥¼ ì„¤ì • </span>\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> checkout<span class=\"token punctuation\">,</span> deploy <span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># ì˜ì¡´ê´€ê³„ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ” jobë“¤ ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ì˜€ì„ ê²½ìš° ë™ì‘í•˜ë„ë¡ ì¡°ê±´ ì„¤ì •</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> always() <span class=\"token important\">&amp;&amp;</span> contains(needs.<span class=\"token important\">*.result</span><span class=\"token punctuation\">,</span> 'failure') <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># runnerê°€ workflowë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ workspaceì— permission ë¶€ì—¬</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set Action Runner Permissions\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sudo chown <span class=\"token punctuation\">-</span>R $USER<span class=\"token punctuation\">:</span>$USER $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.workspace <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># rollback jobì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•˜ì—¬ ë§ˆì§€ë§‰ìœ¼ë¡œ releaseëœ ë²„ì „ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ fetch</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Fetch Latest Release\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> fetch<span class=\"token punctuation\">-</span>latest\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> thebritican/fetch<span class=\"token punctuation\">-</span>latest<span class=\"token punctuation\">-</span>release@v1.0.3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># fetch-latest stepì—ì„œ fetchí•œ ë²„ì „ì˜ ì†ŒìŠ¤ì½”ë“œë¡œ checkout</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout Latest Release source code\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">ref</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.fetch<span class=\"token punctuation\">-</span>latest.outputs.tag_name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># containerë¥¼ ë¹Œë“œí•˜ê³  ë°°í¬í•˜ëŠ” shell scriptë¥¼ ìˆ˜í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build Docker containers\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sh scripts/build<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>compose.sh\n\n    <span class=\"token comment\"># containerì˜ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸í•œ ë’¤ jobì„ ì¢…ë£Œ</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Check container running state\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        if [ $(docker ps --format \"{{.Names}} {{.Status}}\" | grep \"Up\" | wc -l) -ne 3 ]\n        then\n            echo \"Build error while running docker-compose\"\n            exit 1\n        else\n            echo \"Deploy Complete\"\n        fi</span></code></pre></div>\n</li>\n<li>\n<p><code class=\"language-text\">auto-release.yml</code></p>\n<ul>\n<li>pull requestë¥¼ í™œìš©í•œ ì†ŒìŠ¤ì½”ë“œ release, tag ìƒì„± ë° ê´€ë¦¬ ìë™í™”</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Auto Release\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># pull requestê°€ opened / reopened / synchronize / edited / closedë˜ì—ˆì„ ë•Œ ë™ì‘í•˜ëŠ” workflow</span>\n<span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>opened<span class=\"token punctuation\">,</span> reopened<span class=\"token punctuation\">,</span> synchronize<span class=\"token punctuation\">,</span> edited<span class=\"token punctuation\">,</span> closed<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">release</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token comment\"># pull requestê°€ targetìœ¼ë¡œ í•˜ëŠ” branchê°€ mainì¼ ê²½ìš°ì—ë§Œ ìˆ˜í–‰ë˜ë„ë¡ ì¡°ê±´ì„ ì„¤ì •</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> contains(github.base_ref<span class=\"token punctuation\">,</span> 'main') <span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span> contains(github.ref<span class=\"token punctuation\">,</span> 'main') <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># workflowë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì½”ë“œì— ëŒ€í•´ì„œë§Œ sparse checkout ìˆ˜í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Sparse<span class=\"token punctuation\">-</span>checkout\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> lablup/sparse<span class=\"token punctuation\">-</span>checkout@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">patterns</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n            scripts</span>\n    <span class=\"token comment\"># releaseí•  versionëª…ì„ outputìœ¼ë¡œ ì €ì¥í•˜ëŠ” step ìˆ˜í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Extract version\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> extract<span class=\"token punctuation\">-</span>version\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        # releaseëª…ì€ pull requestì˜ titleì— ëª…ì‹œëœ 'ìˆ«ì.ìˆ«ì.ìˆ«ì' í¬ë§·ìœ¼ë¡œ ì„¤ì •\n        # í•´ë‹¹ ê·œì¹™ì„ ì¤€ìˆ˜í•œ releaseëª…ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, ì˜ëª»ëœ ê°’ì´ ì…ë ¥ë˜ì–´ ìˆëŠ” ê²½ìš°ì—ëŠ” ì´í›„ì˜ stepì„ ëª¨ë‘ skip\n        version=$(echo '${{ github.event.pull_request.title }}' | egrep -o '[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}')\n        echo \"::set-output name=version::$version\"</span>\n\n    <span class=\"token comment\"># í˜„ì¬ branchì™€ ì´ì „ ë²„ì „ release ì‚¬ì´ì˜ commit logë“¤ì„ CHANGELOG_RELEASE.mdì— ì €ì¥í•˜ê³ </span>\n    <span class=\"token comment\"># ì¡´ì¬í•˜ë˜ CHANGELOG.mdë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” python scriptë¥¼ ì‹¤í–‰</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Auto Generate Changelog\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> changelog\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        python3 ./scripts/generate_changelog.py --version \"${{ steps.extract-version.outputs.version }}\" --tag \"${{ github.head_ref }}\"</span>\n\n    <span class=\"token comment\"># CHANGELOG_RELEASE.mdì— ë³€ê²½ë‚´ìš©ì´ ì¡´ì¬í•˜ëŠ”ì§€, ì¦‰ ìƒˆë¡œìš´ ë²„ì „ì˜ releaseë¥¼ ìƒì„±í•  í•„ìš”ê°€ ìˆëŠ”ì§€ í™•ì¸</span>\n    <span class=\"token comment\"># í•´ë‹¹ workflowì—ì„œ ì„¤ì •í•œ github action(pull request)ê°€ closeë˜ê³ ,</span>\n    <span class=\"token comment\"># extract-version stepì—ì„œ ì˜¬ë°”ë¥¸ í˜•íƒœì˜ ë²„ì „ëª…ì„ ì–»ì–´ë‚¸ ê²½ìš°ì—ë§Œ ìˆ˜í–‰í•˜ë„ë¡ ì¡°ê±´ì„ ì„¤ì •</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Get Changed Files\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> changed<span class=\"token punctuation\">-</span>files\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.action <span class=\"token tag\">!=</span> 'closed' <span class=\"token important\">&amp;&amp;</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> tj<span class=\"token punctuation\">-</span>actions/changed<span class=\"token punctuation\">-</span>files@v31\n\n    <span class=\"token comment\"># ì´ì „ stepì¸ changed-filesì—ì„œ ë³€ê²½ëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°, íŒŒì¼ì„ staged ìƒíƒœë¡œ ì „í™˜í•œë’¤ ìë™ìœ¼ë¡œ ì»¤ë°‹</span>\n    <span class=\"token comment\"># ì´ ë•Œ, ì»¤ë°‹í•  íŒŒì¼(CHANGELOG.md)ê³¼ ì»¤ë°‹ ë©”ì„¸ì§€ëŠ” with êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì§€ì • </span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Auto Commit Updated Changelog\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> auto<span class=\"token punctuation\">-</span>commit<span class=\"token punctuation\">-</span>push\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.action <span class=\"token tag\">!=</span> 'closed' <span class=\"token important\">&amp;&amp;</span> steps.changed<span class=\"token punctuation\">-</span>files.outputs.any_changed == true <span class=\"token important\">&amp;&amp;</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> stefanzweifel/git<span class=\"token punctuation\">-</span>auto<span class=\"token punctuation\">-</span>commit<span class=\"token punctuation\">-</span>action@v4\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">commit_message</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"update: CHANGELOG.md\"</span>\n        <span class=\"token key atrule\">file_pattern</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CHANGELOG.md\"</span>\n\n    <span class=\"token comment\"># ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²½ìš°, ìƒˆë¡œìš´ ë²„ì „ì˜ releaseì™€ tagë¥¼ ìƒì„±</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Create Release with Tag\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.action == 'closed' <span class=\"token important\">&amp;&amp;</span> github.event.pull_request.merged == true <span class=\"token important\">&amp;&amp;</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version == true <span class=\"token important\">&amp;&amp;</span> contains(github.event.pull_request.title<span class=\"token punctuation\">,</span> 'release') <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ncipollo/release<span class=\"token punctuation\">-</span>action@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">tag</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.extract<span class=\"token punctuation\">-</span>version.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">bodyFile</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"./CHANGELOG_RELEASE.md\"</span>\n        <span class=\"token key atrule\">skipIfReleaseExists</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n</li>\n</ol>\n<br>\n<h2 id=\"ë§ˆë¬´ë¦¬\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"ë§ˆë¬´ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆë¬´ë¦¬</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYElEQVQoz4WS63KCMBCFqSi3ACGSgIDlXnHs6Pu/3Wl3FarWTn+cOSGz+7GXWPnYYzheMEwX1P0RZT2iag/YdxO7LhpEKn+pMMlgihbNcELZfECZCpZpGrz3E/KqW2BFPSLfd9C7GokuEMQaQhoIqVn8HZOnDKE8UzSQaQFLZzXSvOagILoGe+EWUaKxbwY4fgTbCWDZLmvlBFBZxQpVBpEYOEJyjCcSWPX5jO7wiaxsYcqGnf7kBhIy3SGIthz8tvZu8mE74qZg8RUDFaxqmtCOJ8TbHaQuGEbz2XgRlKGzgRvEXB0DbW+p9l6rjQ8vVLCyouXB0ozmQZM2PgFLxCpDKDU2XvgDfRLdc8sEpG3SlmbY7FQhLSRKzBW2ch4Az8ClQtpSvu+51QcgVUhAGnyccsIr2C8gJVO797D7lmmGQqbwQ8VJfwGXlp8f6gxeuyE8IeEKeQX90zK5+/1svgCkAem80os1pQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cicd-005.png\"\n        title=\"cicd-005.png\"\n        src=\"/static/455b5059cc40b360be2fa353138286b2/37523/cicd-005.png\"\n        srcset=\"/static/455b5059cc40b360be2fa353138286b2/e9ff0/cicd-005.png 180w,\n/static/455b5059cc40b360be2fa353138286b2/f21e7/cicd-005.png 360w,\n/static/455b5059cc40b360be2fa353138286b2/37523/cicd-005.png 720w,\n/static/455b5059cc40b360be2fa353138286b2/a0b80/cicd-005.png 955w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span><em>workflow ìˆ˜í–‰ê²°ê³¼</em></p>\n<p>ì´ë ‡ê²Œ <code class=\"language-text\">Github Action</code>ì„ ì‚¬ìš©í•˜ì—¬ ë¹Œë“œ ë° ë°°í¬ë¿ë§Œ ì•„ë‹ˆë¼ ë²„ì „ê´€ë¦¬ê¹Œì§€ ìë™í™”í•  ìˆ˜ ìˆì—ˆë‹¤.\n<code class=\"language-text\">YAML</code> ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ workflowë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê³  github ê³µì‹ ë„íë¨¼íŠ¸ê°€ ë§¤ìš° ì˜ ì •ë¦¬ë˜ì–´ ìˆì–´ì„œ í™œìš©ì´ ë§¤ìš° í¸ë¦¬í–ˆë‹¤.\në‹¤ìŒì—ëŠ” ìë™í™”í•˜ê³  ì‹¶ì€ actionì„ ì§ì ‘ github marketplaceì— ë°°í¬í•´ë³´ëŠ” ê²ƒì´ ëª©í‘œë‹¤!</p>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#cicd-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%84%A4%EA%B3%84%ED%95%B4%EB%B3%B4%EA%B8%B0\">CI/CD í”„ë¡œì„¸ìŠ¤ ì„¤ê³„í•´ë³´ê¸°</a></li>\n<li><a href=\"#github%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-cicd-%ED%99%98%EA%B2%BD-%EA%B4%80%EB%A6%AC\">Githubë¥¼ í™œìš©í•œ CI/CD í™˜ê²½ ê´€ë¦¬</a></li>\n<li><a href=\"#workflow-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\">Workflow êµ¬í˜„í•˜ê¸°</a></li>\n<li><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\">ë§ˆë¬´ë¦¬</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 16, 2022","title":"Github Actionìœ¼ë¡œ EC2ì—ì„œ ë°°í¬ ìë™í™”í•˜ê¸°","categories":"DevOps ci/cd Github","author":"ì†Œí¬","emoji":"ğŸ—£"},"fields":{"slug":"/github/ci-cd/"}},"prev":{"id":"9c38cc4c-2b93-5988-9a44-96136daea0e6","html":"<h2 id=\"ë¹„ë™ê¸°-í”„ë¡œê·¸ë˜ë°ê³¼-ë™ì‘ì›ë¦¬\" style=\"position:relative;\"><a href=\"#%EB%B9%84%EB%8F%99%EA%B8%B0-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EA%B3%BC-%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC\" aria-label=\"ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ê³¼ ë™ì‘ì›ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ê³¼ ë™ì‘ì›ë¦¬</h2>\n<p><strong>ë¹„ë™ê¸°(asynchronous)</strong> ì²˜ë¦¬ëŠ” í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ì‘ì—…ì„ ì²˜ë¦¬í•˜ë„ë¡ ìš”ì²­í•  ìˆ˜ ìˆëŠ” ë°©ì‹ì´ë‹¤. <strong>ë™ê¸°(synchronous)</strong> ì²˜ë¦¬ì™€ ë‹¤ë¥´ê²Œ ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.</p>\n<p>íŒŒì´ì„ ì—ì„œëŠ” ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ì ìš©í•˜ì—¬ ë™ì‹œì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ <code class=\"language-text\">asyncio</code>ë¼ëŠ” ëª¨ë“ˆì„ ì‚¬ìš©í•œë‹¤.</p>\n<br>\n<h2 id=\"coroutineì½”ë£¨í‹´\" style=\"position:relative;\"><a href=\"#coroutine%EC%BD%94%EB%A3%A8%ED%8B%B4\" aria-label=\"coroutineì½”ë£¨í‹´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Coroutine(ì½”ë£¨í‹´)</h2>\n<p>íŠ¹ì • í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ë•Œ, ë°˜ë³µë˜ëŠ” ì‘ì—…ì„ ê°œë³„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ê³  ì´ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ í˜¸ì¶œë˜ì–´ ìˆ˜í–‰ë˜ëŠ” íë¦„ì„ <code class=\"language-text\">Sub Routine</code>ì´ë¼ê³  í•œë‹¤. <code class=\"language-text\">Sub Routine</code>ì€ í•˜ë‚˜ì˜ entry pointë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° í˜¸ì¶œë˜ëŠ” <code class=\"language-text\">Main Routine</code>ì— ì¢…ì†ì ì´ë¼ëŠ” íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆë‹¤.</p>\n<p><code class=\"language-text\">Coroutine</code>ì´ë€ ì„œë¸Œ ë£¨í‹´ì²˜ëŸ¼ íŠ¹ì • í•¨ìˆ˜ì˜ ì‹¤í–‰ì— ì¢…ì†ë˜ì–´ ìˆëŠ” ê²ƒì´ ì•„ë‹Œ, ëŒ€ë“±í•œ ê´€ê³„ë¥¼ ê°€ì§€ê³  ì„œë¡œ ìˆœì°¨ì ìœ¼ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ëœ í•¨ìˆ˜ë¼ê³  í•  ìˆ˜ ìˆë‹¤. <code class=\"language-text\">Sub Routine</code>ê³¼ ë‹¬ë¦¬ ì—¬ëŸ¬ ê°œì˜ entry pointì™€ exit pointë¥¼ ê°€ì§„ë‹¤.\n<code class=\"language-text\">Coroutine</code>ì„ ì´í•´í•˜ê¸° ìœ„í•´ ì•„ë˜ ê°œë…ë“¤ì„ ì•Œ í•„ìš”ê°€ ìˆë‹¤.</p>\n<br>\n<h3 id=\"iteratorì´í„°ë ˆì´í„°\" style=\"position:relative;\"><a href=\"#iterator%EC%9D%B4%ED%84%B0%EB%A0%88%EC%9D%B4%ED%84%B0\" aria-label=\"iteratorì´í„°ë ˆì´í„° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Iterator(ì´í„°ë ˆì´í„°)</h3>\n<p>ìˆœì„œëŒ€ë¡œ ê°’ì„ ë¦¬í„´í•  ìˆ˜ ìˆëŠ” ê°ì²´ì´ë‹¤. í•„ìš”í•œ ê°’ì„ ë©”ëª¨ë¦¬ì— í• ë‹¹í•˜ê³ , ë°˜í™˜í•˜ë„ë¡ ë™ì‘í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. <code class=\"language-text\">iter(object)</code> ë˜ëŠ” <code class=\"language-text\">object.__iter__()</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì˜í•  ìˆ˜ ìˆê³ , <code class=\"language-text\">object.__next__()</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ë¥¼ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ë‹¤ìŒ ê°’ì„ ë¦¬í„´í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ë˜í•œ íŠ¹ì • objectì— <code class=\"language-text\">iter()</code>í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ <code class=\"language-text\">Iterator</code> ê°ì²´ê°€ ìƒì„±ë˜ê³ , ê°ê°ì˜ ê°ì²´ë“¤ì€ ì„œë¡œ ë…ë¦½ì ì¸ ìƒíƒœë¥¼ ê°€ì§€ê²Œ ëœë‹¤.<br>\nì´ëŸ¬í•œ íŠ¹ì„±ì„ í™œìš©í•˜ì—¬ <b>í•„ìš”í•œ ì‹œì ì— ê°ì²´ë¥¼ í˜¸ì¶œí•˜ì—¬ ì—¬ëŸ¬ ì‘ì—…ì„ ë²ˆê°ˆì•„ê°€ë©´ì„œ ìˆ˜í–‰</b>í•˜ë„ë¡ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.\nê°€ì¥ ê°„ë‹¨í•˜ê²Œ forë¬¸ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” íŒŒì´ì„ ì˜ <code class=\"language-text\">range()</code> í•¨ìˆ˜ë¥¼ ì˜ˆë¡œ ë“¤ ìˆ˜ ìˆë‹¤. iteratableí•œ ê°ì²´, ì¦‰ ë°˜ë³µì´ ê°€ëŠ¥í•œ ê°ì²´ë¥¼ ë©”ëª¨ë¦¬ì— í• ë‹¹í•˜ì§€ ì•Šê³  ìˆœì°¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 0 ~ 99ì˜ integerë¥¼ ë³„ë„ì˜ ë©”ëª¨ë¦¬ ê³µê°„ì— í• ë‹¹í•´ë‘ì§€ ì•Šê³ , iterationì´ ë  ë•Œë§ˆë‹¤ êº¼ë‚´ì–´ì„œ ì‚¬ìš©</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n    <span class=\"token builtin\">sum</span> <span class=\"token operator\">+=</span> i</code></pre></div>\n<br>\n<h3 id=\"generatorì œë„ˆë ˆì´í„°\" style=\"position:relative;\"><a href=\"#generator%EC%A0%9C%EB%84%88%EB%A0%88%EC%9D%B4%ED%84%B0\" aria-label=\"generatorì œë„ˆë ˆì´í„° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generator(ì œë„ˆë ˆì´í„°)</h3>\n<p><code class=\"language-text\">__iter__()</code>ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ <code class=\"language-text\">Iterator</code> ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ê°€ì¥ í° ì°¨ì´ëŠ” <code class=\"language-text\">yield</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¤‘ë‹¨ì ì„ ì„¤ì •í•˜ê³  ì‘ì—…ì„ ì¬ê°œí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤. <code class=\"language-text\">generator</code> ê°ì²´ë¥¼ ìƒì„±í•œ ë’¤ <code class=\"language-text\">next(object)</code>ë¥¼ í˜¸ì¶œí•´ì•¼ ì‘ì—…ì´ ì‹œì‘ë˜ë©°, ì‹¤í–‰ ì‹œë§ˆë‹¤ ê°’ì„ ë©”ëª¨ë¦¬ì— í• ë‹¹í•˜ì—¬ ì‚¬ìš©í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>nums<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> nums<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">yield</span> i</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">print<span class=\"token punctuation\">(</span>generator<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span>, <span class=\"token number\">2</span>, <span class=\"token number\">3</span>, <span class=\"token number\">4</span>, <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">))</span>       <span class=\"token comment\"># ê°’ë“¤ì´ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ì–´ ìˆì§€ ì•Šê³ , ê°ì²´ë§Œ ìƒì„±ëœ ìƒíƒœ</span>\n<span class=\"token operator\">>></span> <span class=\"token operator\">&lt;</span>generator object generator at 0x00E3556<span class=\"token operator\"><span class=\"token file-descriptor important\">8</span>></span></code></pre></div>\n<br>\n<p><code class=\"language-text\">generator</code>ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë¥¼ <code class=\"language-text\">caller</code>ë¼ê³  í•˜ì.\n<code class=\"language-text\">caller</code>ì—ì„œ <code class=\"language-text\">next(object)</code>ë¥¼ í˜¸ì¶œí•˜ë©´ ì œì–´ê¶Œì´ <code class=\"language-text\">generator</code>ë¡œ ì „ë‹¬ë˜ê³ , ë¡œì§ì— ë”°ë¼ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. <code class=\"language-text\">yield</code> êµ¬ë¬¸ì„ ë§Œë‚˜ë©´, ì‹¤í–‰ ê²°ê³¼ë¥¼ ì €ì¥í•˜ê³  ë‹¤ì‹œ callerìª½ìœ¼ë¡œ ì œì–´ê¶Œì„ ë°˜í™˜í•œë‹¤. <code class=\"language-text\">caller</code>ê°€ <code class=\"language-text\">generator</code>ë¡œ ê°’ì„ ì „ë‹¬í•  ë•ŒëŠ” <code class=\"language-text\">object.send(value)</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. (ì•„ì§ ì‹œì‘ì´ ë˜ì§€ ì•Šì€ generatorì—ëŠ” <code class=\"language-text\">None</code>ê°’ë§Œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">generator_coroutine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callee 1'</span><span class=\"token punctuation\">)</span>\n    x <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callee 2: %d'</span> <span class=\"token operator\">%</span> x<span class=\"token punctuation\">)</span>\n    x <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span> <span class=\"token number\">2</span>\n\t\ntask <span class=\"token operator\">=</span> generator_coroutine<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ni <span class=\"token operator\">=</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span>    <span class=\"token comment\"># i = 1 / caller 1 ì¶œë ¥</span>\ni <span class=\"token operator\">=</span> task<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># i = 2 / caller 2: 10 ì¶œë ¥</span></code></pre></div>\n<br>\n<p>ë‘ ê°œ ì´ìƒì˜ <code class=\"language-text\">Generator</code>ê°€ ì„œë¡œ ê°’ì„ ì£¼ê³ ë°›ìœ¼ë©´ì„œ êµì°¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ì„œ <code class=\"language-text\">lightweight coroutine</code>ì´ë¼ê³  í‘œí˜„í•˜ê¸°ë„ í•œë‹¤. í•˜ë‚˜ì˜ thread ìœ„ì—ì„œ ì—¬ëŸ¬ ì‹¤í–‰ íë¦„ì´ ì¡´ì¬í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•¨ìœ¼ë¡œì„œ ì‘ì—…ë“¤ì´ ë™ì‹œì— ì§„í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>\n<p><code class=\"language-text\">yield from</code> êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ <code class=\"language-text\">Coroutine</code> ë‚´ë¶€ì—ì„œ <code class=\"language-text\">Sub Coroutine</code>ì„ ì‚¬ìš©í•˜ë„ë¡ êµ¬í˜„í•  ìˆ˜ë„ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">generator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token keyword\">yield</span> <span class=\"token keyword\">from</span> generator_2<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">yield</span> <span class=\"token keyword\">from</span> generator_3<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<blockquote>\n<p><strong><em>NOTE:</em></strong> íŒŒì´ì„ ì—ì„œëŠ” <code class=\"language-text\">yield</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” <code class=\"language-text\">coroutine</code>ì„ <code class=\"language-text\">Generator-based coroutine</code>ì´ë¼ê³  ë¶€ë¥´ê³ , <code class=\"language-text\">asyncio</code> ëª¨ë“ˆì—ì„œ ì§€ì›í•˜ëŠ” <code class=\"language-text\">async/await</code> í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ <code class=\"language-text\">coroutine</code>ì„ ì •ì˜í•˜ëŠ” ë°©ì‹ì„ <code class=\"language-text\">Native coroutine</code>ì´ë¼ê³  ë¶€ë¥¸ë‹¤.</p>\n</blockquote>\n<br>\n<h2 id=\"event-loop\" style=\"position:relative;\"><a href=\"#event-loop\" aria-label=\"event loop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event Loop</h2>\n<p>íŒŒì´ì„  <code class=\"language-text\">asyncio</code>ì—ì„œëŠ” <code class=\"language-text\">coroutine</code>ê³¼ <code class=\"language-text\">event loop</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ì§€ì›í•œë‹¤.</p>\n<p><code class=\"language-text\">coroutine</code> ê°ì²´ê°€ ìƒì„± ë° ë°˜í™˜ í›„ì— <code class=\"language-text\">coroutine</code>ì„ ì‹¤í–‰í•´ì£¼ëŠ” ë¶€ë¶„ì´ ì„ ì–¸ë˜ì–´ ìˆì–´ì•¼ ì‘ì—…(task)ì´ ê°œì‹œëœë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©ë˜ëŠ” ê°œë…ì´ ë°”ë¡œ event loopì´ë‹¤. event loopëŠ” í•˜ë‚˜ì˜ threadì—ì„œ ë“±ë¡ëœ ì—¬ëŸ¬ ì½”ë£¨í‹´ ì‚¬ì´ì˜ ì‹¤í–‰ê¶Œì„ ê°€ì§€ê³  ì—°ì‚°ì„ ìˆ˜í–‰ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤.\nì‰½ê°œ ë§í•˜ë©´, ë¬´í•œíˆ loopë¥¼ ëŒë©°, loopë§ˆë‹¤ ì‘ì—…(task)ì„ í•˜ë‚˜ì”© ì‹¤í–‰ì‹œí‚¤ëŠ” ì¼ì¢…ì˜ ë¡œì§ì´ë‹¤. threadì— event loopë¥¼ ì„¤ì •í•œë‹¤ëŠ” ê²ƒì€ **â€œì‘ì—…, ì¦‰ í•˜ë‚˜ì˜ coroutineì—ì„œ ì¶œë°œí•˜ëŠ” í•˜ë‚˜ì˜ ì‹¤í–‰ íë¦„ì„ ìˆ˜í–‰í•  ìˆ˜ ë¡œì§ì„ ì‹¤í–‰í•  ê°ì²´ë¥¼ ìƒì„±í•œ ê²ƒâ€**ì´ë¼ê³  ì´í•´í•˜ë©´ ëœë‹¤.</p>\n<p>ì´ ë•Œ ì „ë‹¬ë°›ì€ <code class=\"language-text\">coroutine</code> ê°ì²´ëŠ” <code class=\"language-text\">async def</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì˜ëœ í•¨ìˆ˜ì—¬ì•¼ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">coroutine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'coroutine'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">await</span> asyncio<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span>\n\nloop <span class=\"token operator\">=</span> asyncio<span class=\"token punctuation\">.</span>get_event_loop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ë” ì´ìƒ ìˆ˜í–‰ë  taskê°€ ì—†ì„ë•Œê¹Œì§€ ë¬´í•œíˆ loopë¥¼ ëŒë©° ì „ë‹¬ë°›ì€ coroutine ê°ì²´ë¥¼ ì²˜ë¦¬</span>\nloop<span class=\"token punctuation\">.</span>run_until_complete<span class=\"token punctuation\">(</span>coroutine<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># event loopì— ì•„ì§ ì‹¤í–‰ì´ ì¢…ë£Œë˜ì§€ ì•Šì€ taskê°€ ë‚¨ì•„ìˆë‹¤ë©´, ëª¨ë‘ ì œê±°</span>\nloop<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<h3 id=\"futureí“¨ì³ì™€-taskí…ŒìŠ¤í¬\" style=\"position:relative;\"><a href=\"#future%ED%93%A8%EC%B3%90%EC%99%80-task%ED%85%8C%EC%8A%A4%ED%81%AC\" aria-label=\"futureí“¨ì³ì™€ taskí…ŒìŠ¤í¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Future(í“¨ì³)ì™€ Task(í…ŒìŠ¤í¬)</h3>\n<p><code class=\"language-text\">coroutine</code> ë‚´ë¶€ì—ì„œ ë‹¤ë¥¸ ì‘ì—…, ì¦‰ <code class=\"language-text\">sub coroutine</code>ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ì—ëŠ” <code class=\"language-text\">Future</code>, <code class=\"language-text\">Task</code>ì™€ ê°™ì€ <code class=\"language-text\">Awaitable</code>í•œ ê°ì²´(ì‹¤í–‰ì„ ì¢…ë£Œí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ ê°ì²´)ë¥¼ <code class=\"language-text\">await</code>ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>\n<p><code class=\"language-text\">Future</code>ëŠ” ì–´ë– í•œ ì‘ì—…ì˜ ì‹¤í–‰ ìƒíƒœ ë° ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ë¡œ, non-blocking ì‘ì—…ì„ ë¦¬í„´í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. <em>(ì‘ì—…ì˜ ì‹¤í–‰ì„ ì‹œì‘í•˜ëŠ” ì—­í• ì€ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.)</em> <code class=\"language-text\">add_done_callback()</code>ìœ¼ë¡œ ì™„ë£Œ ì‹œì— í˜¸ì¶œí•  ì½œë°±í•¨ìˆ˜ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆê³ , <code class=\"language-text\">result()</code>ë¡œ ì‹¤í–‰ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.</p>\n<p><code class=\"language-text\">Task</code>ëŠ” <code class=\"language-text\">Future</code>ë¥¼ ìƒì†í•œ ê°ì²´ë¡œ, ì‘ì—…ì˜ ì‹¤í–‰ ìƒíƒœ ë° ê²°ê³¼ë¥¼ ì €ì¥í•œë‹¤. <code class=\"language-text\">Future</code>ì™€ëŠ” ë‹¬ë¦¬ ì‘ì—…ì˜ ì‹¤í–‰ì„ ê°œì‹œí•˜ëŠ” ì—­í• ê¹Œì§€ ìˆ˜í–‰í•œë‹¤. <code class=\"language-text\">asyncio.run()</code> ë˜ëŠ” <code class=\"language-text\">asyncio.create_task()</code>í•¨ìˆ˜<text style=\"color:grey;\"> <em>(Python 3.6 ì´ì „ì—ì„œëŠ” <code class=\"language-text\">asyncio.ensure_future()</code>ë¥¼ ì‚¬ìš©)</em> </text>ë¥¼ í˜¸ì¶œí•  ë•Œ <code class=\"language-text\">coroutine</code> ê°ì²´ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ë©´, <code class=\"language-text\">Task</code>ê°ì²´ê°€ ìƒì„±ë˜ë©´ì„œ ì „ë‹¬ë°›ì€ <code class=\"language-text\">coroutine</code>ì´ <code class=\"language-text\">Task</code>ë¡œ ì‹¤í–‰ë˜ë„ë¡ ì˜ˆì•½ëœë‹¤.</p>\n<br>\n<h2 id=\"event-loopê°€-coroutineì„-ì‹¤í–‰í•˜ëŠ”-ë°©ì‹\" style=\"position:relative;\"><a href=\"#event-loop%EA%B0%80-coroutine%EC%9D%84-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EC%8B%9D\" aria-label=\"event loopê°€ coroutineì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event Loopê°€ Coroutineì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹</h2>\n<p><code class=\"language-text\">coroutine</code> ê°ì²´ì˜ ìƒì„± ë° ë°˜í™˜ì´ <code class=\"language-text\">coroutine</code>ì˜ ì‹¤í–‰ì„ ì˜ë¯¸í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•˜ì˜€ë‹¤. ì•„ë˜ëŠ” <code class=\"language-text\">coroutine</code>ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤ì´ë‹¤.</p>\n<p><strong>1. <code class=\"language-text\">await</code> syntax</strong></p>\n<p><code class=\"language-text\">coroutine</code> ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í‚¤ì›Œë“œì´ë‹¤. ë”°ë¼ì„œ <code class=\"language-text\">coroutine</code>ì„ ì²˜ìŒ ì‹¤í–‰í•  ë•ŒëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ê³ , ë‹¤ë¥¸ <code class=\"language-text\">coroutine</code> ë‚´ë¶€ì—ì„œ <code class=\"language-text\">sub coroutine</code>ì„ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë‹¤ë¥¸ <code class=\"language-text\">coroutine</code>ì„ í˜¸ì¶œí•˜ê³ , í•´ë‹¹ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤. ë˜í•œ ë‹¤ë¥¸ <code class=\"language-text\">coroutine</code>ì— ëŒ€í•œ entry pointë¼ê³ ë„ ì´í•´í•  ìˆ˜ ìˆë‹¤.</p>\n<br>\n<p><strong>2. <code class=\"language-text\">asyncio.run()</code> í•¨ìˆ˜</strong></p>\n<p>Â Â Â Â \n<strong>â‘  í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ threadì— ìƒˆë¡œìš´ event loopë¥¼ ì„¤ì •</strong>í•˜ê³ <br>\nÂ Â Â Â \n<strong>â‘¡ ì¸ìë¡œ ì „ë‹¬ë˜ëŠ” <code class=\"language-text\">coroutine</code> ê°ì²´ë¥¼ <code class=\"language-text\">task</code>ë¡œ ì˜ˆì•½í•˜ì—¬ ì‹¤í–‰</strong>í•˜ê³ <br>\nÂ Â Â Â \n<strong>â‘¢<code class=\"language-text\">task</code>ì˜ ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ event loopë¥¼ ë‹«ëŠ” ì—­í• </strong>ì„ ìˆ˜í–‰í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        loop <span class=\"token operator\">=</span> asyncio<span class=\"token punctuation\">.</span>get_running loop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> RuntimeError<span class=\"token punctuation\">:</span>\n        loop <span class=\"token operator\">=</span> asyncio<span class=\"token punctuation\">.</span>new_event_loop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n        loop<span class=\"token punctuation\">.</span>run_until_complete<span class=\"token punctuation\">(</span>coroutine<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        loop<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p><strong><em>NOTE:</em></strong> <code class=\"language-text\">get_event_loop()</code>ëŠ” ì‹¤í–‰ ì¤‘ì¸ event loopë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë¡œ, ì‹¤í–‰ ì¤‘ì¸ event loopê°€ ì—†ëŠ” ê²½ìš°, <code class=\"language-text\">RuntimeError</code>ë¥¼ ë°œìƒì‹œí‚¨ë‹¤. Python 3.10 ì´ìƒì—ì„œëŠ” ì§€ì›ë˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë¡œ, coroutineì´ë‚˜ callbackì—ì„œëŠ” <code class=\"language-text\">get_running_loop()</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.</p>\n</blockquote>\n<br>\n<p><strong>3. <code class=\"language-text\">asyncio.create_task()</code>ì™€ <code class=\"language-text\">asyncio.gather()</code> í•¨ìˆ˜</strong></p>\n<p><code class=\"language-text\">asyncio.run()</code>ì€ ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ taskë¥¼ ì‹¤í–‰í•œë‹¤. ë”°ë¼ì„œ ì—¬ëŸ¬ <code class=\"language-text\">Task</code>ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì‹¤í–‰í•˜ëŠ” ê²½ìš°ì—ë§Œ ë™ì‹œì (concurrent)ì„±ì´ ë³´ì¥ëœë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.\nì „ë‹¬ë°›ì€ ì—¬ëŸ¬ Awaitable ê°ì²´ë“¤ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€, ê·¸ ì™„ë£Œ ê²°ê³¼ë¥¼ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ë°”ë¡œ <code class=\"language-text\">asyncio.gather(*tasks)</code>ì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tasks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>asyncio<span class=\"token punctuation\">.</span>create_task<span class=\"token punctuation\">(</span>_function<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> data_list<span class=\"token punctuation\">]</span> \n    results <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> asyncio<span class=\"token punctuation\">.</span>gather<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>tasks<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># [result_task_1, result_task_2, ...]</span>\n    <span class=\"token keyword\">return</span> results</code></pre></div>\n<br>\n<h2 id=\"ì°¸ê³ \" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"ì°¸ê³  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì°¸ê³ </h2>\n<ul>\n<li><a href=\"https://docs.python.org/3/library/asyncio.html\">https://docs.python.org/3/library/asyncio.html</a></li>\n<li><a href=\"https://it-eldorado.tistory.com/159\">https://it-eldorado.tistory.com/159</a></li>\n<li><a href=\"https://soooprmx.com/asyncio/\">https://soooprmx.com/asyncio/</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B9%84%EB%8F%99%EA%B8%B0-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EA%B3%BC-%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC\">ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ê³¼ ë™ì‘ì›ë¦¬</a></p>\n</li>\n<li>\n<p><a href=\"#coroutine%EC%BD%94%EB%A3%A8%ED%8B%B4\">Coroutine(ì½”ë£¨í‹´)</a></p>\n<ul>\n<li><a href=\"#iterator%EC%9D%B4%ED%84%B0%EB%A0%88%EC%9D%B4%ED%84%B0\">Iterator(ì´í„°ë ˆì´í„°)</a></li>\n<li><a href=\"#generator%EC%A0%9C%EB%84%88%EB%A0%88%EC%9D%B4%ED%84%B0\">Generator(ì œë„ˆë ˆì´í„°)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#event-loop\">Event Loop</a></p>\n<ul>\n<li><a href=\"#future%ED%93%A8%EC%B3%90%EC%99%80-task%ED%85%8C%EC%8A%A4%ED%81%AC\">Future(í“¨ì³)ì™€ Task(í…ŒìŠ¤í¬)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#event-loop%EA%B0%80-coroutine%EC%9D%84-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EC%8B%9D\">Event Loopê°€ Coroutineì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0\">ì°¸ê³ </a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"May 14, 2023","title":"íŒŒì´ì„ ì—ì„œ asyncioë¡œ ë¹„ë™ê¸° ì²˜ë¦¬í•˜ê¸°","categories":"python","author":"ì†Œí¬","emoji":"ğŸ’­"},"fields":{"slug":"/python/asyncio/"}},"site":{"siteMetadata":{"siteUrl":"https://soheeeep.github.io","comments":{"utterances":{"repo":"https://github.com/soheeeeP/soheeeep.github.io"}}}}},"pageContext":{"slug":"/django/migration/","nextSlug":"/github/ci-cd/","prevSlug":"/python/asyncio/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}